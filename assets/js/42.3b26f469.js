(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{564:function(s,a,t){"use strict";t.r(a);var e=t(4),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"_1-superset入门"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-superset入门"}},[s._v("#")]),s._v(" 1. Superset入门")]),s._v(" "),t("h3",{attrs:{id:"_1-1-概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-概述"}},[s._v("#")]),s._v(" 1.1 概述")]),s._v(" "),t("blockquote",[t("p",[s._v("​\tApache Superset是一个开源的、现代的、轻量级BI分析工具，能够对接多种数据源、拥有丰富的图标展示形式、支持自定义仪表盘，且拥有友好的用户界面，十分易用。")])]),s._v(" "),t("h3",{attrs:{id:"_1-2-superset应用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-superset应用场景"}},[s._v("#")]),s._v(" 1.2 Superset应用场景")]),s._v(" "),t("blockquote",[t("p",[s._v("​\t由于Superset能够对接常用的大数据分析工具，如Hive、Kylin、Druid等，且支持自定义仪表盘，故可作为数仓的可视化工具。")])]),s._v(" "),t("h2",{attrs:{id:"_2-superset安装及使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-superset安装及使用"}},[s._v("#")]),s._v(" 2. Superset安装及使用")]),s._v(" "),t("h3",{attrs:{id:"_2-1-安装python环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-安装python环境"}},[s._v("#")]),s._v(" 2.1 安装Python环境")]),s._v(" "),t("blockquote",[t("p",[s._v("Superset是由Python语言编写的Web应用，要求Python3.7的环境。")])]),s._v(" "),t("h4",{attrs:{id:"_2-1-1-安装miniconda"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-1-安装miniconda"}},[s._v("#")]),s._v(" 2.1.1 安装Miniconda")]),s._v(" "),t("p",[s._v("​\tconda是一个开源的包、环境管理器，可以用于在同一个机器上安装不同Python版本的软件包及其依赖，并能够在不同的Python环境之间切换，Anaconda包括Conda、Python以及一大堆安装好的工具包，比如：numpy、pandas等，Miniconda包括Conda、Python。\n此处，我们不需要如此多的工具包，故选择MiniConda。")]),s._v(" "),t("ul",[t("li",[s._v("下载Miniconda（Python3版本）")])]),s._v(" "),t("p",[s._v("下载地址：https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("安装Miniconda")]),s._v(" "),t("ul",[t("li",[s._v("执行以下命令进行安装，并按照提示操作，直到安装完成。bash Miniconda3-latest-Linux-x86_64.sh")])])]),s._v(" "),t("li",[t("p",[s._v("在安装过程中，出现以下提示时，可以指定安装路径 >>> /opt/modult/miniconda3")])]),s._v(" "),t("li",[t("p",[s._v("出现以下字样，即为安装成功：Thank you for installing Miniconda3! (进入lib目录)")])]),s._v(" "),t("li",[t("p",[s._v("加载环境变量配置文件，使之生效： source ~/.bashrc")])]),s._v(" "),t("li",[t("p",[s._v("取消激活 base 环境 conda config --set auto_activate_base false")])])]),s._v(" "),t("h4",{attrs:{id:"_2-1-2-创建python3-7环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-2-创建python3-7环境"}},[s._v("#")]),s._v(" 2.1.2 创建Python3.7环境")]),s._v(" "),t("ol",[t("li",[s._v("配置 conda 国内镜像 (base-home目录)")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("conda config --set show_channel_urls "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("创建 Python3.7 环境 (base-home目录)")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("conda create --name superset "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("python")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.7")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("conda环境管理常用命令：")]),s._v(" "),t("p",[s._v("创建环境：conda create -n env_name\n查看所有环境：conda info --envs\n删除一个环境：conda remove -n env_name --all")]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("激活 superset环境")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("conda activate superset\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 退出环境")]),s._v("\nconda deactivate\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"_2-2-superset部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-superset部署"}},[s._v("#")]),s._v(" 2.2 Superset部署")]),s._v(" "),t("h4",{attrs:{id:"_2-2-1-安装依赖"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-安装依赖"}},[s._v("#")]),s._v(" 2.2.1 安装依赖")]),s._v(" "),t("p",[s._v("进入 superset 环境执行以下步骤")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y gcc gcc-c++ libffi-devel python-devel python-pip python-wheel python-setuptools openssl-devel cyrus-sasl-devel openldap-devel\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"_2-2-2-安装superset"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-安装superset"}},[s._v("#")]),s._v(" 2.2.2 安装Superset")]),s._v(" "),t("ol",[t("li",[s._v("安装（更新）setuptools和pip")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("pip "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --upgrade setuptools pip -i https://pypi.douban.com/simple/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("pip是python的包管理工具，可以和centos中的yum类比")]),s._v(" "),t("p",[s._v("-i 的作用是指定镜像，这里选择国内镜像")]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("安装Supetset")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("pip "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" apache-superset -i https://pypi.douban.com/simple/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("如果遇到网络错误导致不能下载，可尝试更换镜像")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("pip "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" apache-superset --trusted-host https://repo.huaweicloud.com -i https://repo.huaweicloud.com/repository/pypi/simple\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("初始化Supetset数据库")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("superset db upgrade\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"4"}},[t("li",[s._v("创建管理员用户")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("FLASK_APP")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("superset\nsuperset fab create-admin\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改秘密")]),s._v("\nsuperset fab reset-password --username admin --password "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("flask是一个python web框架，Superset使用的就是flask")]),s._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[s._v("Superset初始化")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("superset init\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h5",{attrs:{id:"_2-2-2-1-关于-superset-db-upgrade-执行报错记录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-1-关于-superset-db-upgrade-执行报错记录"}},[s._v("#")]),s._v(" 2.2.2.1 关于 superset db upgrade 执行报错记录")]),s._v(" "),t("ol",[t("li",[s._v("ImportError: cannot import name ‘TypedDict’ from ‘typing’")])]),s._v(" "),t("blockquote",[t("p",[s._v("关于TypedDict的这个error，其实是Python版本的问题，这里需要将更换为Python3.9")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.退出环境")]),s._v("\nconda deactivate\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.卸载 Superset")]),s._v("\nconda remove -n superset --all\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.查看是否卸载成功「没有superset环境即成功」")]),s._v("\nconda info --envs\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.重载Python3.9环境")]),s._v("\nconda create --name superset "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("python")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.9")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.激活环境")]),s._v("\nconda activate superset\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.继续执行2.2.1 安装依赖 等操作")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("ImportError: cannot import name ‘soft_unicode’ from ‘markupsafe’")])]),s._v(" "),t("blockquote",[t("p",[s._v("3.7和3.9均有这个error，'soft_unicode' from 'markupsafe':这个错误涉及到markupsafe的版本，需要退回到2.0.1")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("pip uninstall markupsafe"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\npython -m pip "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("markupsafe")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v(".1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("Error: Could not locate a Flask application. Use the 'flask --app' option, 'FLASK_APP' environment variable, or a 'wsgi.py' or 'app.py' file in the current directory.")])]),s._v(" "),t("blockquote",[t("p",[s._v("这是由于一开始创建的superset不是管理员用户，执行以下命令即可：export FLASK_APP=superset")])]),s._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[s._v("No module named 'werkzeug.wrappers.etag'")])]),s._v(" "),t("blockquote",[t("p",[s._v("依旧是版本问题：werkzeug版本需要从2.2.2降到2.0.1")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("pip uninstalll werkzeyg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\npip "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("werkzeug")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v(".1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ol",{attrs:{start:"5"}},[t("li",[s._v("如若依旧不成功")])]),s._v(" "),t("p",[s._v("将 Superset的版本降为 1.4.2")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("pip "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" apache-superset"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.4")]),s._v(".2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("再次执行「superset db upgrade」命令\n看到大量「info」且没有Error即部署成功Superset")])]),s._v(" "),t("h4",{attrs:{id:"_2-2-3-启动supterset"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-启动supterset"}},[s._v("#")]),s._v(" 2.2.3 启动Supterset")]),s._v(" "),t("ol",[t("li",[s._v("安装gunicorn (superset环境home目录)")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("pip "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" gunicorn -i https://pypi.douban.com/simple/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("gunicorn是一个Python Web Server，可以和java中的TomCat类比")])]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("启动Superset")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("gunicorn --workers "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" --timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("120")]),s._v(" --bind hadoop102:8787  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"superset.app:create_app()"')]),s._v(" --daemon\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("--workers：指定进程个数\n--timeout：worker进程超时时间，超时会自动重启\n--bind：绑定本机地址，即为Superset访问地址\n--daemon：后台运行")]),s._v(" "),t("p",[s._v("登录 SuperSet")]),s._v(" "),t("p",[s._v("http://hadoop102:8787  使用前面配置的 admin账户进行登录")]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("停止 Superset")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/superset/ && !/awk/{print $2}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" -9\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 退出环境")]),s._v("\nconda deactivate\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h4",{attrs:{id:"_2-2-4-superset启停脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-4-superset启停脚本"}},[s._v("#")]),s._v(" 2.2.4 superset启停脚本")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("superset_status")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("result")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/gunicorn/ && !/awk/{print $2}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$result")]),s._v(" -eq "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("superset_start")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/.bashrc\n        superset_status "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/dev/null "),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&1")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$?")]),s._v(" -eq "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n            conda activate superset "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" gunicorn --workers "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" --timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("120")]),s._v(" --bind hadoop102:8787 --daemon "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'superset.app:create_app()'")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"superset正在运行"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("superset_stop")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    superset_status "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/dev/null "),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&1")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$?")]),s._v(" -eq "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"superset未在运行"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/gunicorn/ && !/awk/{print $2}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" -9\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n    start "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"启动Superset"')]),s._v("\n        superset_start\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    stop "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"停止Superset"')]),s._v("\n        superset_stop\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    restart "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"重启Superset"')]),s._v("\n        superset_stop\n        superset_start\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    status "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        superset_status "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/dev/null "),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&1")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$?")]),s._v(" -eq "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"superset未在运行"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"superset正在运行"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("esac")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br")])]),t("h2",{attrs:{id:"_3-superset使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-superset使用"}},[s._v("#")]),s._v(" 3. Superset使用")]),s._v(" "),t("h3",{attrs:{id:"_3-1-对接mysql数据源"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-对接mysql数据源"}},[s._v("#")]),s._v(" 3.1 对接MySQL数据源")]),s._v(" "),t("h4",{attrs:{id:"_3-1-1-安装依赖"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-1-安装依赖"}},[s._v("#")]),s._v(" 3.1.1 安装依赖")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("superset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("saberlind@hadoop102 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ conda "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" mysqlclient\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("说明：对接不同的数据源，需安装不同的依赖，以下地址为官网说明\nhttps://superset.apache.org/docs/databases/installing-database-drivers")]),s._v(" "),t("h4",{attrs:{id:"_3-1-2-重启superset"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-2-重启superset"}},[s._v("#")]),s._v(" 3.1.2 重启Superset")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("superset.sh restart\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"_3-1-3-数据源配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-3-数据源配置"}},[s._v("#")]),s._v(" 3.1.3 数据源配置")]),s._v(" "),t("ol",[t("li",[s._v("Database配置")])]),s._v(" "),t("p",[s._v("Step1：点击Data/Databases")]),s._v(" "),t("p",[s._v("Step2：点击＋DATABASE")]),s._v(" "),t("p",[s._v("Step3：点击填写Database及SQL Alchemy URI")]),s._v(" "),t("p",[s._v("注：SQL Alchemy URI编写规范：mysql://用户名:密码@主机名:端口号/数据库名称\n此处填写：\nmysql://root:123456@hadoop102:3306/gmall_report?charset=utf8")]),s._v(" "),t("p",[s._v("Step4：点击Test Connection，出现“Connection looks good!”提示即表示连接成功")]),s._v(" "),t("p",[s._v("Step5：点击ADD")]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("Table 配置")])]),s._v(" "),t("p",[s._v("Step1：点击Data/ Datasets")]),s._v(" "),t("p",[s._v("Step2：点击 + Datasets")]),s._v(" "),t("p",[s._v("Step3：配置Table（ads_uv_count）")]),s._v(" "),t("h3",{attrs:{id:"_3-2-制作仪表盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-制作仪表盘"}},[s._v("#")]),s._v(" 3.2 制作仪表盘")]),s._v(" "),t("h4",{attrs:{id:"_3-2-1-创建空白仪表盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-创建空白仪表盘"}},[s._v("#")]),s._v(" 3.2.1 创建空白仪表盘")]),s._v(" "),t("p",[s._v("Step1：点击Dashboards/+DASHBOARDS")]),s._v(" "),t("p",[s._v("Step2：命名并保存")]),s._v(" "),t("h4",{attrs:{id:"_3-2-2-创建图表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-创建图表"}},[s._v("#")]),s._v(" 3.2.2 创建图表")]),s._v(" "),t("p",[s._v("Step1：点击Charts/+CHART")]),s._v(" "),t("p",[s._v("Step2：选择数据源及图表类型")]),s._v(" "),t("p",[s._v("Step3：选择合适的图表类型")]),s._v(" "),t("p",[s._v("Step4：创建图表")]),s._v(" "),t("p",[s._v("Step5：按照说明配置图表")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://lskyimage-1306894954.cos.ap-nanjing.myqcloud.com/bigdataprjct%2Fsuperset-config.png",alt:""}})]),s._v(" "),t("p",[s._v("Step6：点击“Run Query”")]),s._v(" "),t("h2",{attrs:{id:"_4-superset-实战"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-superset-实战"}},[s._v("#")]),s._v(" 4. Superset 实战")])])}),[],!1,null,null,null);a.default=n.exports}}]);