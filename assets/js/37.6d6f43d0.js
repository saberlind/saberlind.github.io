(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{559:function(_,v,t){"use strict";t.r(v);var s=t(4),a=Object(s.a)({},(function(){var _=this,v=_.$createElement,t=_._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("h2",{attrs:{id:"_1-dws层的设计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-dws层的设计"}},[_._v("#")]),_._v(" 1. DWS层的设计")]),_._v(" "),t("h3",{attrs:{id:"_1-1-dws层的定位"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-dws层的定位"}},[_._v("#")]),_._v(" 1.1 DWS层的定位")]),_._v(" "),t("ul",[t("li",[_._v("轻度聚合，因为DWS层要应对很多实时查询，如果是完全的明细那么查询的压力是非常大的。")]),_._v(" "),t("li",[_._v("将更多的实时数据以主题的方式组合起来便于管理，同时也能减少维度查询的次数。")])]),_._v(" "),t("h2",{attrs:{id:"_2-dws-访客主题宽表计算"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-dws-访客主题宽表计算"}},[_._v("#")]),_._v(" 2. DWS-访客主题宽表计算")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[_._v("统计主题")])]),_._v(" "),t("th",[t("strong",[_._v("需求指标")])]),_._v(" "),t("th",[t("strong",[_._v("输出方式")])]),_._v(" "),t("th",[t("strong",[_._v("计算来源")])]),_._v(" "),t("th",[t("strong",[_._v("来源层级")])])])]),_._v(" "),t("tbody",[t("tr",[t("td",[t("strong",[_._v("访客")])]),_._v(" "),t("td",[_._v("pv")]),_._v(" "),t("td",[_._v("可视化大屏")]),_._v(" "),t("td",[_._v("page_log直接可求")]),_._v(" "),t("td",[_._v("dwd")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("访客")])]),_._v(" "),t("td",[_._v("uv")]),_._v(" "),t("td",[_._v("可视化大屏")]),_._v(" "),t("td",[_._v("需要用page_log过滤去重")]),_._v(" "),t("td",[_._v("dwm")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("访客")])]),_._v(" "),t("td",[_._v("跳出率")]),_._v(" "),t("td",[_._v("可视化大屏")]),_._v(" "),t("td",[_._v("需要通过page_log行为判断")]),_._v(" "),t("td",[_._v("dwm")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("访客")])]),_._v(" "),t("td",[_._v("进入页面数")]),_._v(" "),t("td",[_._v("可视化大屏")]),_._v(" "),t("td",[_._v("需要识别开始访问标识")]),_._v(" "),t("td",[_._v("dwd")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("访客")])]),_._v(" "),t("td",[_._v("连续访问时长")]),_._v(" "),t("td",[_._v("可视化大屏")]),_._v(" "),t("td",[_._v("page_log直接可求")]),_._v(" "),t("td",[_._v("dwd")])])])]),_._v(" "),t("p",[_._v("设计一张DWS层的表其实就两件事：维度和度量(事实数据)")]),_._v(" "),t("ul",[t("li",[_._v("度量包括PV、UV、跳出次数、进入页面数(session_count)、连续访问时长")]),_._v(" "),t("li",[_._v("维度包括在分析中比较重要的几个字段：渠道、地区、版本、新老用户进行聚合")])]),_._v(" "),t("h3",{attrs:{id:"_2-1-需求分析与思路"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-需求分析与思路"}},[_._v("#")]),_._v(" 2.1 需求分析与思路")]),_._v(" "),t("ul",[t("li",[_._v("接收各个明细数据，变为数据流")]),_._v(" "),t("li",[_._v("把数据流合并在一起，成为一个相同格式对象的数据流")]),_._v(" "),t("li",[_._v("对合并的流进行聚合，聚合的时间窗口决定了数据的时效性")]),_._v(" "),t("li",[_._v("把聚合结果写在数据库中")])]),_._v(" "),t("h3",{attrs:{id:"_2-2-功能实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-功能实现"}},[_._v("#")]),_._v(" 2.2 功能实现")]),_._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[_._v("\n")])]),_._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[_._v("1")]),t("br")])]),t("h2",{attrs:{id:"_3-总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-总结"}},[_._v("#")]),_._v(" 3. 总结")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("DWS层主要是基于DWD和DWM层的数据进行轻度聚合统计")])]),_._v(" "),t("li",[t("p",[_._v("掌握利用union操作实现多流的合并")])]),_._v(" "),t("li",[t("p",[_._v("掌握窗口聚合操作")])]),_._v(" "),t("li",[t("p",[_._v("掌握对clickhouse数据库的写入操作")])]),_._v(" "),t("li",[t("p",[_._v("掌握用FlinkSQL实现业务")])]),_._v(" "),t("li",[t("p",[_._v("掌握分词器的使用")])]),_._v(" "),t("li",[t("p",[_._v("掌握在FlinkSQL中自定义函数的使用")])])])])}),[],!1,null,null,null);v.default=a.exports}}]);